<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>SkillBridge - Resume Tracker</title>
  <link rel="stylesheet" href="style.css" />
</head>

<body>

  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const sidebar = document.getElementById('sidebar');
      if (sidebar) sidebar.classList.remove('hide');
    });
  </script>

  <div class="app">

    <!-- Sidebar -->
    <aside class="sidebar" id="sidebar">
      <div class="sidebar-header">
        <h2 class="logo">SkillBridge</h2>
        <button class="close-btn" onclick="closeSidebar()">‚úñ</button>
      </div>

      <nav>
        <button onclick="window.location.href='index.html'"
          title="Get an overview of your career progress and key metrics">üìä Dashboard</button>
        <button onclick="window.location.href='skills-analysis.html'"
          title="Analyze your skills with interactive charts and industry comparisons">üß† Skill Analysis</button>
        <button onclick="window.location.href='roadmap.html'"
          title="Explore personalized career paths with guidance and connections">üõ£Ô∏è Career Roadmap</button>
        <button onclick="window.location.href='internships.html'"
          title="Find internships and project opportunities to build experience">üöÄ Internships & Projects</button>
        <button class="active" onclick="window.location.href='resume.html'"
          title="Track and optimize your resume for better job prospects">üìÑ Resume Tracker</button>
      </nav>
    </aside>

    <!-- Main -->
    <div class="main">
      <header class="navbar">
        <div style="display: flex; gap: 10px; align-items: center;">
          <button class="back-btn" onclick="window.history.back()" title="Go back">‚Üê Back</button>
          <button class="menu-btn" onclick="openSidebar()">‚ò∞</button>
        </div>
        <h1 id="pageTitle">Resume Tracker</h1>
        <div class="profile" onclick="logout()" style="cursor: pointer;">üë§ Student</div>
      </header>

      <main class="content" id="content">
        <!-- Resume Sections Container -->
        <div class="resume-sections-container">
          
          <!-- 1. Example Resume Section -->
          <div class="resume-card">
            <div class="card-header">
              <h2>üìã Example Resume</h2>
              <p>View professional resume templates and samples</p>
            </div>
            <div class="card-body">
              <div class="examples-grid">
                <div class="example-item">
                  <h4>Frontend Developer</h4>
                  <p>Learn from a professional frontend developer resume with modern CSS, JavaScript skills.</p>
                  <button class="card-btn" onclick="viewExampleResume('frontend')">View Template</button>
                </div>
                <div class="example-item">
                  <h4>Data Scientist</h4>
                  <p>See how to structure a data science resume with Python, ML, and analytics expertise.</p>
                  <button class="card-btn" onclick="viewExampleResume('data')">View Template</button>
                </div>
                <div class="example-item">
                  <h4>Full Stack Engineer</h4>
                  <p>Explore a comprehensive full stack engineer resume with both frontend and backend skills.</p>
                  <button class="card-btn" onclick="viewExampleResume('fullstack')">View Template</button>
                </div>
              </div>
            </div>
          </div>

          <!-- 2. Generate Resume Section -->
          <div class="resume-card">
            <div class="card-header">
              <h2>‚ú® Generate Resume</h2>
              <p>Create your custom resume with AI-powered suggestions</p>
            </div>
            <div class="card-body">
              <div class="generate-form-container">
                <form id="resumeForm">
                  <div class="form-group">
                    <label>Full Name</label>
                    <input type="text" id="resumeName" placeholder="Enter your full name" required>
                  </div>

                  <div class="form-row">
                    <div class="form-group">
                      <label>Email</label>
                      <input type="email" id="resumeEmail" placeholder="your@email.com" required>
                    </div>
                    <div class="form-group">
                      <label>Phone</label>
                      <input type="tel" id="resumePhone" placeholder="+91-XXXXXXXXXX" required>
                    </div>
                  </div>

                  <div class="form-group">
                    <label>Education</label>
                    <textarea id="resumeEducation" placeholder="B.Tech in Computer Science, 2020-2024&#10;CGPA: 3.8" rows="3"></textarea>
                  </div>

                  <div class="form-group">
                    <label>Professional Skills</label>
                    <textarea id="resumeSkills" placeholder="HTML, CSS, JavaScript, React, Node.js, MongoDB" rows="3"></textarea>
                  </div>

                  <div class="form-group">
                    <label>Work Experience</label>
                    <textarea id="resumeExperience" placeholder="Frontend Intern at XYZ Corp, June 2023 - Aug 2023&#10;‚Ä¢ Developed responsive web applications&#10;‚Ä¢ Improved UI performance by 40%" rows="4"></textarea>
                  </div>

                  <div class="form-group">
                    <label>Projects</label>
                    <textarea id="resumeProjects" placeholder="Portfolio Website - Personal portfolio built with React and Tailwind CSS" rows="3"></textarea>
                  </div>

                  <button type="button" class="generate-btn" onclick="generateResume()">
                    üöÄ Generate Resume
                  </button>
                </form>
              </div>

              <div class="upload-section">
                <h4>Or Upload Existing Resume</h4>
                <div class="file-upload-area">
                  <input type="file" id="resumeUpload" accept=".pdf,.doc,.docx" onchange="uploadResume()">
                  <p>Drop your resume here or click to browse</p>
                  <span>Supported formats: PDF, DOC, DOCX</span>
                </div>
                <div id="uploadStatus"></div>
              </div>
            </div>
          </div>

          <!-- 3. Resume Tracker Section -->
          <div class="resume-card">
            <div class="card-header">
              <h2>üìä Resume Tracker</h2>
              <p>Track your resume progress and applications</p>
            </div>
            <div class="card-body">
              <div class="tracker-info">
                <p>üéØ Start building and tracking your resume to land your dream job!</p>
              </div>
              <div class="tracker-features">
                <div class="feature">
                  <span class="feature-icon">‚úÖ</span>
                  <h5>Track Applications</h5>
                  <p>Monitor which companies you've applied to</p>
                </div>
                <div class="feature">
                  <span class="feature-icon">üìà</span>
                  <h5>Optimize Score</h5>
                  <p>Improve your resume with AI recommendations</p>
                </div>
                <div class="feature">
                  <span class="feature-icon">üéì</span>
                  <h5>Build Skills</h5>
                  <p>Learn what skills to add for better opportunities</p>
                </div>
              </div>
              <button class="tracker-btn" onclick="window.location.href='index.html'">
                Go to Dashboard & Build Resume
              </button>
            </div>
          </div>

          <!-- Generated Resume Output -->
          <div class="resume-card" id="resumeOutput" style="display: none;">
            <div class="card-header">
              <h2>‚úÖ Your Generated Resume</h2>
              <button class="close-preview" onclick="document.getElementById('resumeOutput').style.display='none'">‚úï</button>
            </div>
            <div class="card-body">
              <div id="resumeContent"></div>
              <div class="resume-actions">
                <button class="action-btn" onclick="downloadResume()">üì• Download PDF</button>
                <button class="action-btn" onclick="editResume()">‚úèÔ∏è Edit Resume</button>
              </div>
            </div>
          </div>
        </div>
      </main>
    </div>

  </div>

  <script src="https://www.gstatic.com/firebasejs/12.0.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/12.0.0/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/12.0.0/firebase-firestore-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/12.0.0/firebase-storage-compat.js"></script>
  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyCgffF2_yiVYND2pl4j3-JJezYrI0Gzw7I",
      authDomain: "skill-bridge-92cff.firebaseapp.com",
      projectId: "skill-bridge-92cff",
      storageBucket: "skill-bridge-92cff.firebasestorage.app",
      messagingSenderId: "379886840265",
      appId: "1:379886840265:web:f73b1fc51080a2b7ace018",
      measurementId: "G-JKWNG1Y836"
    };

    firebase.initializeApp(firebaseConfig);
    window.auth = firebase.auth();
    window.db = firebase.firestore();
    const auth = firebase.auth();
    const db = firebase.firestore();

    auth.onAuthStateChanged(async (user) => {
      if (user) {
        const userDoc = await db.collection("users").doc(user.uid).get();
        if (userDoc.exists) {
          const userData = userDoc.data();
          document.querySelector('.profile').textContent = userData.name;
        }
      } else {
        window.location.href = 'login.html';
      }
    });
  </script>
  <script>
    const sidebar = document.getElementById("sidebar");
    // Ensure sidebar is visible on load
    window.addEventListener('load', () => {
      if (sidebar) {
        sidebar.classList.remove('hide');
      }
    });
    function openSidebar() { if (sidebar) sidebar.classList.remove("hide"); }
    function closeSidebar() { if (sidebar) sidebar.classList.add("hide"); }
    function logout() {
      window.auth.signOut().then(() => {
        window.location.href = 'login.html';
      }).catch((error) => {
        console.error('Logout error:', error);
      });
    }
    window.openSidebar = openSidebar;
    window.closeSidebar = closeSidebar;
    window.logout = logout;

    function generateResume() {
      const name = document.getElementById("resumeName").value;
      const email = document.getElementById("resumeEmail").value;
      const phone = document.getElementById("resumePhone").value;
      const education = document.getElementById("resumeEducation").value;
      const skills = document.getElementById("resumeSkills").value;
      const experience = document.getElementById("resumeExperience").value;
      const projects = document.getElementById("resumeProjects").value;

      const content = document.getElementById("resumeContent");
      content.innerHTML = `
      <div style="text-align: center; margin-bottom: 20px;">
        <h2>${name}</h2>
        <p>${email} | ${phone}</p>
      </div>
      <div>
        <h4>Education</h4>
        <p>${education}</p>
      </div>
      <div>
        <h4>Skills</h4>
        <p>${skills}</p>
      </div>
      <div>
        <h4>Experience</h4>
        <p>${experience}</p>
      </div>
      <div>
        <h4>Projects</h4>
        <p>${projects}</p>
      </div>
    `;

      const output = document.getElementById("resumeOutput");
      output.style.display = "block";
    }

    function uploadResume() {
      const fileInput = document.getElementById("resumeUpload");
      const file = fileInput.files[0];
      const status = document.getElementById("uploadStatus");

      if (!file) {
        status.innerHTML = '<p style="color: red;">Please select a file first.</p>';
        return;
      }

      if (!file.type.includes('pdf') && !file.type.includes('word')) {
        status.innerHTML = '<p style="color: red;">Please upload a PDF or Word document.</p>';
        return;
      }

      status.innerHTML = '<p>Uploading...</p>';

      const storageRef = firebase.storage().ref();
      const resumeRef = storageRef.child(`resumes/${auth.currentUser.uid}/${file.name}`);

      resumeRef.put(file).then((snapshot) => {
        status.innerHTML = '<p style="color: green;">Resume uploaded successfully!</p>';
        // You can save the download URL to Firestore if needed
        snapshot.ref.getDownloadURL().then((downloadURL) => {
          console.log('File available at', downloadURL);
          // Save to user's profile in Firestore
          db.collection("users").doc(auth.currentUser.uid).update({
            resumeURL: downloadURL,
            resumeName: file.name
          });
        });
      }).catch((error) => {
        status.innerHTML = '<p style="color: red;">Upload failed. Please try again.</p>';
        console.error('Upload failed:', error);
      });
    }
  </script>
</body>

</html>